hello and welcome to the session on time
series forecasting in this video we are
going to talk about what time series
forecasting is
so this is what we are going to cover in
this video first of all why time series
and then we'll talk about what exactly
is time series data and then what are
the components of a time series data
like for example the trend seasonality
and so on and then we will explain what
each of these components are we'll also
talk about when we should not use time
series analysis and
we will then explain what is
stationary data in terms of time series
what is the significance of stationary
data and typically time series data is
not stationary so how to make time
series data stationary and then we will
take it through an example of a car
sales data and we will show you how to
solve the time series or how to perform
the time series analysis
manually without using the tool and then
we will do in the second part we will
actually use r and we will do the same
thing once again in r okay so without
any further delay let's get started and
so why exactly do we need to do time
series analysis typically we would like
to predict something in the future and
it could be stock prices it could be the
sales or
anything that needs to be predicted into
the future that is when we
use time series analysis
so it is
as the name suggests it is forecasting
and typically when we say predict it
need not be into the future in machine
learning and data analysis when we talk
about predicting we are not necessarily
talking about the future but in time
series analysis we typically predict the
future so we have some past data and we
want to predict the future that is when
we perform time series analysis so what
are some of the examples it could be
daily stock price the shares as we talk
about or it could be the interest rates
weekly interest rates or sales figures
of a company so these are some of the
examples where we use time series data
we have historical data which is
dependent on time and then based on that
we create a model to predict the future
so what exactly is
time series so time series data has time
as one of the components as the name
suggests so in this example let's say
this is the stock price data and
one of the components so there are two
columns here column b is
price and column a is basically the time
information in this case the time is a
day so that primarily the closing price
of a particular stock has been recorded
on a daily basis so this is a time
series data and the time interval is
obviously a day time series or time
intervals can be daily weekly hourly or
even sometimes there is something like a
sensor data it could be every few
milliseconds or microseconds as well so
the size of the time intervals can vary
but they are fixed so if i'm saying that
it is daily data then the interval is
fixed as uh daily if i'm saying this
data is an hourly data then it is the
data is captured every year and so on so
the time intervals are fixed the
interval itself you can decide based on
what kind of data we are capturing so
this is a graphical representation the
previous one here we saw the table
representation and this is how the plot
the data so on the y-axis is let's say
the price or the the stock price and
x-axis is the time so against time if
you plot it this is how a time series
graph would look so as the name suggests
what is time series data time series
data is basically a sequence of data
that is recorded over a specific
intervals of time and based on the past
values so if we want to do an analysis
of time series past data we try to
forecast a future and
again as the name suggests is time
series data which means that it is time
dependent so time is one of the
components of this data time series data
consists of primarily four components
one is the trend then we have the
seasonality then cyclicity and then last
but not least irregularity or the random
component sometimes is also referred to
as a random component so let's see what
each of these components are so what is
trend trend is overall
change or the pattern of the data which
means that the data may be let me just
uh pull up to pen and
show you so let's say you have a data
set somewhat like this a time series
data set somewhat like this all right
so what is the overall trend there is an
overall
trend which is upward trend as we call
it here right so it is not like it is
continuously increasing there are times
when it is dipping then there are times
when it is increasing then it is
decreasing and so on but overall over a
period of time from the time we start
recording to the time we end there is a
trend right there is an upward trend in
this case so the trend need not always
be upwards there could be a downward
trend as well so for example here there
is a downward trend right so this is
basically what is a trend overall
whether the data is increasing or
decreasing all right then we have the
next component which is seasonality what
is seasonality seasonality as the name
suggests once again changes over a
period of time and periodic changes
right so there is a certain pattern um
let's take the sales of warm clothes for
example so if we plot it along the
months so let's say january february
march april may july and then let's say
it goes up to december okay so this is
our
december a d
i will just mark it as t and then you
again have jan feb march and then you
get another december okay and just for
simplicity let's mark these as decembers
as the end of the year and then one more
december
okay so what will happen when if you are
talking about warm clothes what happens
the sales of warm clothes will increase
probably around december when it is cold
and then they will come down and then
again
around december again they will increase
and then the sales will come down and
then there will be again an increase and
then they will come down and then again
an increase and then they will come down
let's see this is the sales pattern so
you see here there is a trend as well
there is an upward trend right the sales
are increasing over let's say these are
multiple years this is for year one this
is for year two this is for year three
and so on so for multiple years overall
the trend there is an upward trend the
sales are increasing but it is not a
continuous increase right so there is a
certain pattern so what is happening
what is the pattern every
december the sales are increasing or
they are peaking for that particular
year right then there is a new year
again when december approaches the sales
are increasing again when december
approaches the sales are increasing and
so on and so forth so this is known as
seasonality so there is a certain
fluctuation
which is which is periodic in nature so
this is known as seasonality then
cyclicity what is cyclicity now
cyclicity is somewhat similar to
seasonality but here the duration
between two cycles is much longer so
seasonality typically is referred to as
an annual kind of a sequence like for
example we saw here so it is pretty much
like every year in the month of december
the sales are increasing however
cyclicity what happens is first of all
the duration is pretty much not fixed
and the duration or the gap length of
time between two cycles can be much
longer so the recession is an example so
we had let's say recession in 2001 or
2002 perhaps and then we had one in 2008
and then we had probably in 2000 2012
and so on and so forth so it is not like
every year this happens probably so
there is usually when we say recession
there is a slump and then it recovers
and then there is a slump and then it
recovers and probably there is another
bigger slump and so on right so you see
here this is similar to seasonality but
first of all this length is much more
than a year
right that is number one and it is not
fixed as well it is not like every four
years or every six years that duration
is not fixed so the
duration can vary at the same time the
gap between two cycles is much longer
compared to seasonality all right so
then what is irregularity irregularity
is like the random component of the time
series data so there is like you have
part which is the trend which tells
whether the overall it is increasing or
decreasing then you have cyclicity and
seasonality which is like kind of a
specific pattern right
then there is a cyclicity which is again
a pattern but at much longer intervals
plus there is a random component so
which is not really which cannot be
accounted for very easily right so there
will be a random component which can be
really random as the name suggests right
so that is the irregularity component so
these are the various components of time
series data yes there are conditions
where we cannot use time series analysis
right so is it can we do time series
analysis with any kind of data no not
really so what are the situations where
we are
we cannot do time series analysis so
there will be some data which is
collected over a period of time but it's
really not changing so
it will not really not make sense to
perform any time series analysis over it
right for example like this one so if we
take x as the time and y is the value of
whatever the output we are talking about
and if the y value is constant there is
really no analysis that you can do
leave alone time series analysis right
so that is one another possibility is
yes there is a change but it is changing
as per a very fixed function like a sine
wave or a cos wave again time series
analysis will not make sense in this
kind of a situation because there is a
definite pattern here there is a
definite function that the data is
following so it will not make sense to
do a time series analysis
now before performing any time series
analysis
the data has to be stationary and
typically time series data is not
stationary so in which case you need to
make the data stationary before we apply
any models like arima model or any of
these right so what exactly is
stationary data and what is meant by
stationary data let us take a look first
of all what is non-stationary data time
series data if you recall from one of my
earlier slides we said that time series
data has the following four components
the trend seasonality cyclicity and
random random component or irregularity
right so if these components are present
in time series data it is non-stationary
which means that typically these
components will be present therefore
most of the time a time series data that
is collected raw data is non-stationary
data so it has to be changed to
stationary data before we apply any of
these algorithms
all right so a non stationary time
series data would look like this which
means like for example here there is an
upward trend the seasonality component
is there and
also the random component and so on so
if the data is not stationary then the
time series forecasting will be affected
so you cannot really perform a time
series forecasting on a non-stationary
data so how do we differentiate between
a stationary and a non-stationary time
series data typically or technically one
is of course you can do it visually in
non-stationary data the the data will be
more flattish the seasonality will of
course be there but the trend will not
be there so the data may if we plot that
it may appear somewhat like this right
it's a horizontal line along the
horizontal line you will see compared to
the original data which was there was an
upward trend so it was changing somewhat
like this right so this is
non-stationary data and this is our
stationary data would look visually what
does this mean technically this means
that stationarity of the data depends on
a few things what the mean the variance
and the covariance so these are the
three components on which the
stationarity of the data depends so
let's take a look at what each of these
are for stationary data the mean should
not be a function of time which means
that the mean should pretty much remain
constant over a period of time right so
there is there shouldn't be any change
uh so this is how the stationary data
would look and this is how a
non-stationary data would look as shown
in the previous slide as well so here
the mean is increasing that means there
is an upward trend okay so that is one
part of it and then the variance of the
series should not be also a function of
time so the variance also should be
pretty much common or
should be constant rather so this is a
if we visually we take a look this is
how time series stationaries data would
look where the variance is not changing
here the variance is changing therefore
this is non-stationary and we cannot
apply type series forecasting on this
kind of data similarly the covariance
which is basically of the ith term and
the i plus m term should not be a
function of time as well so covariance
is nothing but not only the variance
at the i-th term but the relation
between the variance at the i-th term
and the i plus m-m-th or the i-plus and
that term so as again once again
visually this is how it would look if
the covariance is also changing with
respect to time so these are the three
all three components should be pretty
much constant that is when you have
stationary data and in order to perform
time series analysis the data should be
stationary okay so let's take a look at
the concept of moving average or the
method of moving average and let's see
how it works we'll do simple
calculations so let's say this is our
sample data we have the data for three
months january february march the sales
in hundreds of in thousands rather not
hundreds thousands of dollars is given
here and now we want to find the moving
average so how do we find the moving
average we call it as moving average
three so moving average three is nothing
but you take three of the values or the
readings add them up and uh divide by
three basically the way we take a mean
or average of the three values so that
is as simple as that so that's the
average first of all so what is moving
average moving averages if you now have
a series of data you keep taking the
three values the next three values and
then you take the average of that and
then the next three values and so on and
so forth so that is how you take the
moving average so let's take a little
more detailed example of car sales so
this is how we have the car sales data
for the entire year let's say so rather
for four years so year one we have for
each quarter quarter one two three four
and then year two quarter one two three
four and so on and so forth so this is
how we have sales data of a particular
car let's say or a showroom and
we want to forecast for year five so we
have the data for four years we now want
to forecast for the fifth year let's see
how it works first of all if we plot the
data as it is uh taken the raw data this
is how it would look and uh what do you
think it is is it stationary no right
because there is a trend upward trend so
this is not a stationary data so we um
we need to later we will see how to make
it stationary but to start with just an
example we will not worry about it for
now we will just go ahead and manually
do the
forecasting using what is known as
moving average method okay so we are not
applying any algorithm or anything like
that in the next video we will see how
to apply an algorithm how to make it
stationary and so on all right so
here we see that all the three or four
components that we talked about um are
there there is a trend there is a
seasonality and then of course there is
some random component as well cyclicity
may not be it is possible that cyclicity
is not applicable in all the situations
for sales especially there may not be
unless you're taking a sales for maybe
20 30 years cyclicity may not come into
play so we will just consider uh
primarily the trend seasonality and
irregularity right so random it is also
known as random irregularity right so we
were calling the random or irregularity
component so these are the three main
components typically in this case we
will talk about so this is the trend
component and
we will see how to do these calculations
so let's take a look
redraw the table including the time code
we will add another column which is the
time code and uh this is the column and
we'll just number it like one two three
four up to 16. the rest of the data
remains the same okay so we will do the
calculations now now let us do the
moving average calculations um or ma4 as
we call it for each year so we take all
the four quarters and we take an average
of that so if we add up these four
values and divide by four you get the
moving average of 3.4 so we start by
putting the value here so that will be
for the third quarter let's say one two
three the third quarter then we will go
on to the next one so we take the next
four values as you see here and take the
average of that which is the moving
average for the next quarter and so on
and so forth now if we just do the
moving average it is not centered so
what we do is we basically add one more
column and we calculate the centered
moving average as shown here so here
what we do is we take the average of two
values and then just adding these values
here so for example the first value for
the third quarter is actually the
average of the third and the fourth
quarter so we have 3.5 now it gets
centered so similarly the next value
would be 3.6 plus 3.9 divided by 2 so
which is 3.7 and so on and so forth okay
so that is the centered moving average
this is done primarily to smoothen the
data so that there are not too many
rough edges so that is what we do here
so
if we visualize this data now uh this is
how it looks right so
if we take the centered moving average
as you can see there is a gradual
increase if this was not the case if we
had not centered it the changes would
have been much sharper so
that is the basically the smoothing that
we are talking about now let's go and or
do the forecast for the fifth year so in
order to do the forecast what we will do
is we will take the centered moving
average as our baseline and then start
doing a few more calculations that are
required in order to come up with the
prediction so what we are going to do is
we are going to use this multiplicity or
multiplicative model in this case and
this is how it it looks so we take the
product of seasonality and
the trend and the irregularity
components and we just multiply that and
in order to get that this product of
these two we have basically the actual
value divided by cma yt value divided by
cma will give you the predicted value of
yt is equal to the product of all three
components therefore
t into y t is equal to y t by c m a so
this is like this is equal to y t right
so therefore if we want st into y t the
product of seasonality and irregularity
it is equal to y t by c cma so that is
how we will work it out i also have an
excel sheet of the actual data so let me
just pull that up all right so this is
how the data looks in excel as you can
see here year one quarter one two three
four here two quarter one two three four
and so on and this is the sales data and
then this is the moving average as i
mentioned this is how we calculate and
this is the centered moving average so
this is the primary component that we
will start working with and then we will
calculate since we want the product of
sc into yt that is equal to yt by cma so
if you see these values are nothing but
the yt value divided by cma so in this
case it is 4 by 3.5 which is 1.14
similarly 4.5 by 3.7 1.22 and so on and
so forth so we take we have the product
as tm2i t and then the next step is to
calculate the average of
respective quarters so that is what we
are doing here average of respective
quarters and then we need to calculate
the decisionalized values so in order to
get decisionalized value we need to
divide yt by
st that was calculated so for example
here it is 2.8 by 0.9 so we got the
decisionalized value here and
then we get the trend and then we get
the predicted values so in order to get
the predicted value which is basically
we predict the values for known values
as well like for example here one
quarter one we know the value but now
that we have our model we predict
ourselves and see how close it is so we
predicted as 2.89 whereas the actual
value is 2.8 then we have 2.59 the
actual value is 2.1 and so on just to
see how our model works and then
continue that into the fifth year
because for fifth year we don't have a
reference value okay and if we plot this
we will come to know how well our
calculations are how well our manual
model in this case we did not really use
a model but we did on our own manually
so it will tell us the trend so for
example the predicted value is this gray
color here and you can see that it is
actually pretty much following the
actual value which is the blue color
right and the gray color is the
predicted value so the wherever we know
the values up to year 4 we can see that
our predicted values are following or
pretty much very close to the actual
values and then from here onwards when
the year 5 starts the blue color line is
not there because we don't have the
actual values only the predicted value
so we can see that since it was
following the trend pretty much for the
last four years we can safely assume
that it has understood the pattern and
it is predicting correctly for the next
one year the next four quarters right so
that is what we are doing here so these
four quarters we did not have actual
data but we have the predicted values so
let's go back and see how this is
working in this using the slides so this
is we already saw this part and
i think it was easier to see in the
excel sheet so we calculated the st i t
the product of s t and i t using the
formula like here y by y t by c m a we
got that and then we got st which is
basically yt so this is the average of
the first quarters for all the four
years and
similarly this is the average of the
second quarter for all the four years
and so on so these values are repeating
these are they are calculated only once
they get repeated as you can see here
and
then we get the decisionalized data and
that is basically yt by st so we
calculated st here and we have yt so yt
by st will give you the dc analyze data
and
we have got rid of the seasonal and the
irregular components so far now what we
are left with is the trend and
before we
start the time series forecasting time
series analysis as i mentioned earlier
we need to completely get rid of the
non-stationary components so we are
still left with the trend component so
now let us also remove the trend
component in order to do that we have to
find the or we have to calculate the
intercept and slope of the data because
that is required to calculate the trend
and uh how are we going to do that we
will actually use um what is known as a
regression tool or analytics tool that
is available in excel so you remember we
have our data in excel so let me take
you to the excel and
here we need to calculate the intercept
and the slow in order to do that we have
to use the regression mechanism and in
order to use the regression mechanism we
have to use the analytics tool that
comes with excel so how do you
activate this tool so this is how you
would need to activate the tool uh from
excel you need to go to options
and
in options
there will be add-ins and
in add-ins you will have um analysis
tool back and you select this
and
you just say go it will open up a box
like this you say analysis tool pack and
you say okay and now when you come back
in to the regular view of excel in the
data tab you will see data analysis
activated so you need to go to file
options
and add-ins
and then analysis tool pack typically
since i've already added it it is coming
at the top but it would
come under inactive application add-ins
so when you're doing it for the first
time so don't use vba you just say
analysis tool back there are two options
one with vba like this one and one
without vba so just use the one without
vba and then instead of just saying okay
just take care that you click on this go
and not just okay so you say go then it
will give you these options only then
you select just the analysis tool pack
and then you say okay all right so
and then when you come back to the main
view you click on data okay so this is
your normal home view perhaps so you
need to come to data and here is where
you will see data analysis available to
you and then if you click on that there
are a bunch of possibilities what kind
of data analysis you want to do if there
are options are given right now we just
want to do regression because we want to
find the slope and the intercept so
select regression and you say ok
and you will get these options for input
y range and input x range input y range
is the value yt so you just select this
and you can select up to here and press
enter and input x range you can for now
you start with uh the baseline or you
can also start with the d seasoned
values so you can just click on these
and say okay
i have already calculated it so these
are the intercept and the coefficients
that we are getting for these values and
we will actually use that to calculate
our trend here right so which is in the
j column so our trend is equal to
intercept plus slope into the time code
so
the intercept is
out here as we can see in our slide as
well so if you see here this is our
intercept and the lower value is the
slope we have calculated here and it's
shown in the slides as well so intercept
so the formula is shown here so our
trend is equal to intercept plus slope
into time code time code is nothing but
this one t column a one two three four
okay so that's how you calculate the
trend and that's how you use the data
analysis tool from excel using these two
we calculate the predicted values and
using this formula which is basically
trend is equal to intercept plus slope
into time code and then we can go and
plot it see how it is
looking and therefore so we see here
that the predicted values are pretty
close to the actual values and
therefore we can safely assume that our
calculations which are like our manual
model is working and hence we go ahead
and predict for the fifth year so till
four years we know the actual value as
well so we can compare our model is
performing and for the fifth year we
don't have reference values so we can
use our equations to calculate the
values or predict the values for the
fifth year and we can go ahead and
safely calculate those values and when
we plot for the fifth year as well the
predicted values we see that they are
pretty much they captured the pattern
and we can safely assume that the
predictions are fairly accurate as we
can also see from the graph in the excel
sheet that we have already seen okay so
let's go and plot it so this is how the
plot looks this is the cma or the
centred moving average the green color
and then the blue color is the actual
data red color is the predicted value
predicted by our hand crafted model okay
so remember we did not use any regular
forecasting model or any tool we have
done this manually and
the actual tool will be used in the next
video this is just to give you an idea
about how behind the scenes or under the
hood how forecasting works or time
series analysis how it is performed okay
so it looks like it has captured the
trend properly so up to here is the
known difference we have reference and
from here onwards is purely predicted
and
as i mentioned earlier we can safely
assume that the values are accurate and
predicted properly for the fifth year so
let's go ahead and implement a time
series forecast in r first of all we
will be using the arimo model to do the
forecast of this time series data so let
us try to understand what is arima model
so arima is actually an acronym it
stands for autoregressive integrated
moving average so that is what is arima
model and it is specified by three
parameters which is p d and q p stands
for auto regressive so let me just mark
this so there are three components here
auto regressive integrated moving
average okay so these three parameters
correspond to those three components so
the p stands for auto regressive d for
integrated and q for moving average so
let us see what exactly this is so these
three factors are p is the number of
autoregressive terms or ar we will see
that in a little bit and d is how many
levels of differences that we need to do
or differentiation we need to do and q
is the number of lagged forecast errors
so we'll see what exactly each of these
are so ar is the number of
autoregressive terms and which is
basically denoted by the p
and then we have d which is for the
number of times it has to be
differentiated
and then we have q which is for
the moving average so what exactly are
terms so in terms of the regression
model autoregressive components
refer to the prior values of the current
value what we mean by that is here when
we talk about time series data focus on
the fact that there is regression so
what exactly happens in regression we
try to do something like if it is simple
linear regression we do some equation
like y is equal to mx plus c where there
are actually there are two variables one
is the dependent variable and then there
is an independent variable let me just
complete this equation as well mx plus c
right so this is a normal regression
curve or a simple regression curve now
here we are talking about auto
regression or or autoregressive so
autoregressive as the name suggests is
regression of itself so which means that
here you have only one variable which is
your maybe the cost of the flights or
whatever it is right and the other
variable is basically time dependent and
therefore the value at any given time
and that we will denote as y t for
example so there is no x here there is
only one variable and which is y and we
say y t which is basically the predicted
value at a time interval t for example
is dependent on the previous value so
for example there may be a one and then
y t minus one and then there will be
like plus a 2 and right plus a 2 and y t
minus 2 and
all right and then plus a 3 into y t
minus 3 all right so basically here what
we're saying is there's only one
variable here but there is a regression
component so we are doing a regression
on itself so that's how the term auto
regression comes into play so only thing
is that it is dependent on the previous
time values so there is a lag let's say
this is the first lag second lag third
lag and so on so the current value which
is y t is dependent on the previous time
lag values so that is what is not a
regression component so this is what is
shown here for example in this case
instead of y we are calling it as x so
that's the same and this is represented
by some equation of that sort depending
on how many lags we take so that is the
ar component and the term p is basically
determines how many lags we are
considering so that's the p4 now what is
d d is the degree of differencing so
here differencing is like to for the
non-seasonal differences right so for
example if you take the values like this
which are given for 5 4 6 and so on and
so forth if you take the differencing of
one after another like for example 5
minus 4 or 4 minus 5 the next value with
the previous value so 4 minus 5. so this
is known as the first order differencing
so the result is minus 1 similarly 6
minus 4 is 2 7 minus 6 is 1. so this is
first order differencing and
here we call it as d is equal to one
okay and same way we can have second
order third order and so on then the
last one is q q is the actually we call
it moving average but in reality it is
actually the error of the model so we
also sometimes represent as e t all
right so now arima model works on the
assumption that the data is stationary
which means that the trend and
seasonality of the data has been removed
that is correct okay so this we have
discussed in the first part how what
exactly is stationary data and how do we
remove the non-stationary part of it now
in order to test whether the data is
stationary or not there are two
important components that are considered
one is the autocorrelation function and
the other is the partial autocorrelation
function so this is referred to as acf
and tsef right so what is
autocorrelation and what is the
definition or the correlation is
basically the similarity between values
of a same variable across observations
as the name suggests now how do we
actually find the autocorrelation
function the value right so this is
basically done by plotting and
autocorrelation function also tells you
how correlated points are with each
other based on how many time steps they
are separated by and so on that is
basically the time lag that we were
talking about and it is also used to
determine how past and future data
points are related and the value of the
autocorrelation function can vary from
minus one to one so if we plot this is
how it would look autocorrelation
function would look somewhat like this
and there is actually a readily
available function in r so we will see
that and you can use that to plot your
autocorrelation function okay so that is
acf and we will see that in our r studio
in a little bit and similarly you have
partial autocorrelation function so
partial autocorrelation function is the
degree of association between two
variables while adjusting the effect of
one or more additional variables so this
again can be measured and it can also be
plotted and its value once again can go
from -1 to 1 and it gives the partial
correlation of time series with its own
lagged values so lag again we have
discussed in the previous couple of
slides this is how a psef plot would
look in our studio we will see that as
well and once we get into the r studio
and with that let's get into r studio
and take a look at our use case before
we go into the code let's just quickly
understand what exactly is the objective
of this use case so we are going to
predict some values or forecast some
values and we have the data of the
airline ticket sales of the previous
years and now we will try to find the or
predict or forecast the values for the
future years all right so
we will basically
identify the time series components like
trend seasonality and
random behavior we will actually
visualize this in our studio and then we
will actually forecast the values based
on the past values or history data
historical data so these are the steps
that we follow we will see in our studio
in a little bit just quickly let's go
through what are the steps we load the
data and it is a time series data and we
try to find out what class it belongs to
the data is actually air passengers data
that is already comes pre-loaded with
rstudio so we will be using that and we
can take a look at the data and then
what is the starting point what is the
end point so these are all functions
that are really available we'll be using
and then what is the frequency there's
basically frequency is 12 which is like
yearly data right so every month the
data has been collected so for each year
it is 12 and then we can check for many
missing values if there are any and then
we can take a look at the summary of the
data this is what we do in exploratory
data analysis and then we can plot the
data visualize the data how it is
looking and we will see how the data has
some trend seasonality and so on and so
forth all right then we can take a look
at the cycle of the data using the cycle
function and we can see that it is every
month that's the cycle and of every 12
months
a new cycle begins so each month of the
year as
the data is available then we can do box
plots to see for each month how the data
is varying over the various 10 or 12
years that we will be looking at this
data and
from
exploratory data analysis we can
identify that there is a trend there is
a seasonality component and how the
seasonality component varies also we can
see from the box plots and we can
decompose the data we can use the
decomposed function rather to see the
various components like the seasonality
trend and the irregularity part okay so
we will see all of this in our studio
this is how they will look this is the
once you decompose and this is how you
will actually you can visualize the data
this is the actual data and this is the
trend as you can see it's going upwards
this is the seasonal component and this
is your random or irregularity right so
we call it irregularity or we can also
call it random as you can see here yes
so the data must have a constant
variance and mean which means that it is
stationary before we start any analysis
time series analysis and we thought so
basically if it is stationary only then
it is easy to model the data perform
time series analysis so we can then go
ahead and fit the model as we discussed
earlier we'll be using arima model there
are some techniques to find out what
should be the parameter so we will see
that when we go into rstudio so
the auto arima function basically tells
us what should be the parameters right
so these parameters are the p d and q
that we talked about that's what is
being shown here so if we use auto arima
it will basically take all possible
values of this pdq these parameters and
it will find out what is the best value
and then it will
recommend so that is the advantage of
using auto arima all right so like in
this case it will tell us what if we use
this parameter trace we set the
parameter trace is equal to true then it
will basically tell us what is the value
of this aic which has to be minimum so
the lower the value the better so for
each of these combinations of b d and q
it will give us the values here and then
it will recommend to us which is the
best model okay because whichever has
the lowest value of this aic it will
recommend that as your best pdq values
so once we have that we can see that we
will basically we can potentially get a
model or the equation model is nothing
but the equation and based on the
parameters that we get and we can do
some diagnostics we can do some plotting
to see how whether there is a plot for
the residuals so which shows the
stationarity and then we can also take a
look at the acf and pscf we can plot the
acf and psef and then we can do some
forecasting for the future here so in
this case we have up to 1960 and then we
can see how we can forecast for the next
10 years which is 1970 up to 1970 and
once we have done this can we validate
this model yes definitely we can
validate this model and
to validate the findings we use uh
junkbox test and this is how you just
call box.test and then you pass these
parameters and you will get the values
that will be returned which will tell us
whether this how accurate this model is
how accurate the connections are so the
values of p are quite insignificant in
this case we will see that and that also
indicates that our model is free of
autocorrelation and that will basically
be it so let's go back and into our
rstudio and
go through these steps in real time so
we have to import this library forecast
package is not installed you have to go
here and install the forecast package
okay so that's the easy way to install
rather than so click on this install i
will not do it now because i have
already installed so the first time
that's only one time then after that you
just have to load it into memory and
then keep going so we will load this
data called air passengers so
by calling this data method and if you
see the the data passengers is loaded
here and if we check for the class it is
a time series data ts data so we can
check for the dates we can also view the
data in a little bit and start date is
1949 and january
and our end date is 1960 december
and the frequency is 12 which is
like collected monthly so
that is the frequency which is uh 12
here and then we
check if there are any missing values
there are no missing values and then we
take a look at the summary of the data
this is all exploratory data analysis
and then if you just display the data
this is how it looks
and then we need to decompose this data
so we will kind of
store this in an object ts data and then
use that to decompose and store the new
values let me just clear this for now
and
if we decompose basically as we have
seen in the slides decomposing is
breaking it into the trend seasonality
and the irregular or random components
then you can go ahead and plot it so
when you plot it you can see here let me
zoom this this is our original plot or
observed value as it is known as then we
have decomposed the three parts which is
basically the trend as you can see there
is a poor trend then the seasonal
component so this is a some regularly
occurring pattern and then there is a
random value which is basically you
cannot really give any equation or
function or anything like that so that's
what this plotting has done and then you
can actually plot them individually as
well so these are the individual plots
for the trend for the seasonal component
and the random component all right so
now let's take a look at the original
data and see how the trend is in a way
so if we do this linear regression line
it will show that it is going upwards
and we can also take a look at the cycle
that are there which is nothing but we
have a frequency of 12 right so the
cycles will display that it is january
february to december and then back to
january february and so on and so forth
and if we do box plots for the monthly
data you will see that for each of the
months right and over the 10 years that
the data that we have we will see that
there is a certain pattern right this is
also in a way to find the seasonality
component so
while january february sales are
relatively low around july august the
sales pick up so especially in july i
think the sales are the highest and this
seems to be happening pretty much every
year right so this is every year in july
there seems to be a peak in the sales
and then it goes down and slightly
higher in december and so on so that is
again part of our exploratory data
analysis and once again let's just plot
the data now as i said in order to fit
into an arima model we need the values
of pd and q now one way of doing it is
there are multiple ways actually of
doing it the earlier method of doing it
was you draw the autocorrelation
function plot and then partial
autocorrelation function plot and then
observe that and where does this change
and then identify what should be the
values of p and q and so on now r really
has a very beautiful
method which we can use to avoid all
that manual process that we used to do
earlier so what r will do is there is a
method called auto arima and if we just
call this auto arima method and it will
basically go and test the arima model
for all possible values of this
parameters pdq and then it will suggest
to you what should be the best model and
it will return that best model with the
right values of pd and q so you we as
data scientists don't have to do any
manual you know trial and error kind of
stuff okay so we got the model now and
uh this is the model it it has pdq
values r211 pdq and this is the seasonal
part of it so we can ignore it for now
and so if we want to actually understand
how this has returned these values 2 1 1
as the best one there is another
functionality or feature where we can
use this trace function or trace
parameter so if you pass to auto arima
the trace parameter what it will do is
it will show you how it is doing this
calculation what is the value of the aic
basically asc is what you know defines
the accuracy of the model the lower the
better okay so for each combination of
pdq it will show us the value of aic so
let's run it before instead of me
talking so much let's run this if we run
auto arima with trace you see here there
is a red mark here that means it is
performing it's executing this and here
we see the display right so it starts
with certain values of pdq and then it
finds that value is too high so it
starts with again with some 0 1 1 0 and
so on and so forth and ultimately it
tells us okay this is our best model you
see here it says this is our best model
2 1 1. let's go back and see did we get
the same one yes we got the same one
when we ran without trace as well right
now y is 2 1 1 let us see where is 2 1 1
here is our 2 1 1 and if you compare the
values you see that 1 0 1 7 is pretty
much the lowest value and therefore it
is saying this is our best model all
other values are higher so that's how
you kind of
get your model and now that you have
your model what you have to do you need
to predict the values right so before
that let us just do some tests of these
values so for that you install t series
again if you are doing it for the first
time you would rather use this package
and install and say t series and install
it and then you just use this library
function to load it into your memory all
right so now that we got our model using
auto arima let us go ahead and forecast
and also test the model and also plot
the acf and pscf remember we talked
about this but we did not really use it
we don't have to use that but at least
we will visualize it and for some of the
stuff we may need this t series
library so if you are doing this for the
first time you may have to install it
and my recommendation is don't use it in
the code you go here and install t
series and i will not do it now because
i have already installed it but this is
a preferred method and once you install
it you just load it using this library's
function and then you can plot your
residuals and this is how the residuals
look and you can plot your acf and psef
okay so this is how your psef looks and
this is how your acf looks for now there
is really nothing else we need to do
with acf and psef is just to visualize
how that how it looks but as i mentioned
earlier we were actually using these
visualizations of these graphs to
identify the values of p d and q and how
that was done it's
out of scope of this video so we will
leave it at that and
then we will forecast for the next 10
years how do we focus that so we call
forecast and we pass the model and we
pass what is the level of accuracy that
you need which is 95 percent and for how
many periods right so basically we want
for 10 years which is like 10 into 12
time periods so that's what we are doing
here and now we can plot the forecast
value so you see this is the original
value up to i think 62 or whatever and
then it goes up to 72 this blue color is
the predicted value let's go and zoom it
up so that we can see it better so from
here onwards your forecasting and you
can see that it looks like our model has
kind of learned the pattern and this
pattern looks very similar to what we
see in the actual data now how do we
test our
model so we can do what is known as a
box test and we pass our model here
residuals basically with different lags
and from those values here the p values
here we find that they are reasonably
low p values which means our model is
fairly accurate with that we come to the
end of this video i hope you enjoyed
this thank you very much once again for
joining and if you have any comments or
questions please put it at the bottom of
the video and preferably with some
contact information so that we can get
back to you and you have a great day
thank you once again bye
hi there if you like this video
subscribe to the simply learn youtube
channel and click here to watch similar
videos turn it up and get certified
click here
